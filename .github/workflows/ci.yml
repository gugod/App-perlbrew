name: CI

on: pull_request

jobs:
  TestDist:
    runs-on: ubuntu-latest
    name: Test the dist
    steps:
      - uses: actions/checkout@v2
      - name: mbtiny dist
        uses: docker://docker.io/library/perl:5.36
        with:
          args: |
            bash -c "
              cpanm --quiet --notest App::ModuleBuildTiny
              mbtiny dist
              echo ./App-perlbrew-*.tar.gz
            "
      - name: install on perl 5.36
        uses: docker://docker.io/library/perl:5.36
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - name: install on perl 5.34
        uses: docker://docker.io/library/perl:5.34
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - name: install on perl 5.14
        uses: docker://docker.io/library/perl:5.14
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - name: install on perl 5.12
        uses: docker://docker.io/library/perl:5.12
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
