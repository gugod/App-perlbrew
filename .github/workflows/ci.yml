name: CI

on: pull_request

jobs:
  DistThenTest:
    runs-on: ubuntu-latest
    name: mbtiny on perl 5.36
    steps:
      - uses: actions/checkout@v2
      - uses: docker://docker.io/library/perl:5.36
        with:
          args: |
            bash -c "
              cpanm --quiet --notest App::ModuleBuildTiny
              mbtiny dist
              echo ./App-perlbrew-*.tar.gz
            "
      - uses: docker://docker.io/library/perl:5.36
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - uses: docker://docker.io/library/perl:5.34
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - uses: docker://docker.io/library/perl:5.14
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
      - uses: docker://docker.io/library/perl:5.12
        with:
          args: bash -c "cpanm --verbose ./App-perlbrew-*.tar.gz"
